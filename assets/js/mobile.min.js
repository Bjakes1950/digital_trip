/* Created by deemidroll | deemidroll@gmail.com | 2014 */
var initPhoneController=function(){function a(a){j=!0,$("#forward").css("transform","rotate("+a+"deg)"),c>a?($("#stopRight, #turnRight").removeClass("active"),a>d?$("#stopLeft").addClass("active"):$("#turnLeft").addClass("active")):a>e?($("#stopLeft, #turnLeft").removeClass("active"),f>a?$("#stopRight").addClass("active"):$("#turnRight").addClass("active")):$("#stopLeft, #turnLeft, #stopRight, #turnRight").removeClass("active")}var b=window.location.origin,c=-3,d=-20,e=3,f=20,g=$("#controller"),h=($("#gameConnect"),$("#wheel")),i=$("#status"),j=!1;g.show(),window.addEventListener("orientationchange",function(){var a=0-window.orientation;$("body").css({transform:"rotate("+a+"deg)","-ms-transform":"rotate("+a+"deg)","-webkit-transform":"rotate("+a+"deg)","-moz-transform":"rotate("+a+"deg)"})},!1);var k=function(){var c=$("#socket input").val(),d=io.connect(b);d.on("welcome",function(){d.emit("device",{type:"controller",gameCode:c})}),d.on("message",function(a){"vibr"===a.type&&(console.log("vibtare",a.time),navigator.vibrate(a.time)),"gameover"===a.type&&(console.log("gameover"),g.hide(),$("#gameover").show())}),d.on("connected",function(){$("#socket").hide(),h.show(),document.addEventListener("touchstart",function(){d.emit("accelerate",{accelerate:!0}),$("#forward").addClass("active")},!1),document.addEventListener("touchend",function(){d.emit("accelerate",{accelerate:!1}),$("#forward").removeClass("active")},!1),document.addEventListener("touchmove",function(a){a.preventDefault()},!1),window.addEventListener("deviceorientation",function(b){var c=b.alpha,e=(b.beta,b.gamma),f=e;a(f),d.emit("turn",{turn:f,g:c})},!1),window.addEventListener("MozOrientation",function(b){var c=b.alpha,e=(b.beta,b.gamma),f=e;a(f),d.emit("turn",{turn:f,g:c})},!1),j||($("#turnLeft").click(function(){d.emit("click",{click:"left"})}),$("#turnRight").click(function(){d.emit("click",{click:"right"})})),$(".button").show(),$("#M").click(function(){d.emit("click",{click:"mute"})}),$("#P").click(function(){d.emit("click",{click:"pause"})}),$("#restart").click(function(){d.emit("click",{click:"restart"}),$("#gameover").hide(),g.show()})}),d.on("fail",function(){i.html("Failed to connect! Reload!")}),$(document).unbind("keyup",l)},l=function(a){var b=a.keyCode;13===b&&k()};$("#connect").click(k),$(document).bind("keyup",l)};
//# sourceMappingURL=mobile.min.map